<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="../../css/bootstrap-grid.css">
    <link rel="stylesheet" href="../../css/bootstrap.css">
    <link rel="stylesheet" href="../../css/bootstrap-reboot.css">
    <link rel="stylesheet" href="../../css/font-awesome.css">
    <script src="../../js/jquery.3.2.1.min.js"></script>
    <script src="../../js/bootstrap.bundle.js"></script>
    <script src="../../js/bootstrap.js"></script>
    <script src="../../js/holder.js"></script>
    <style>
        body{
            margin-top: 70px;
            background-color: #b3d7ff;
        }
    </style>
    <script src="../../js/vue.js"></script>
    <script src="../../js/validator.min.js"></script>
    <link rel="stylesheet" href="../../dialog/dialog.css">
    <script src="../../dialog/dialog.js"></script>
    <script src="../../js/qs.js"></script>
    <script src="../../js/axios.min.js"></script>
</head>
<body>

    <div class="container-fluid" id="roleInfo">
    <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top">

        <a class="navbar-brand text-center" href="#" >二手物品后台管理</a>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="#">主页<span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown1" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <span class="fa fa-battery-4 text-info">系统监控</span>
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown1">
                        <a class="dropdown-item" href="#">sql监控</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#">缓存监控</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#">系统信息</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#">访问日志</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#">服务器监控</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#">在线用户</a>
                    </div>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown5" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <span class="fa fa-envelope text-info">消息推送</span>
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown5">
                        <a class="fa fa-plus dropdown-item text-info" href="#">写入消息</a>
                        <div class="dropdown-divider"></div>
                        <a class="fa fa-pencil dropdown-item text-warning" href="#">未完成</a>
                        <div class="dropdown-divider"></div>
                        <a class="fa fa-search dropdown-item text-info" href="#">已完成</a>
                    </div>
                </li>

                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown2" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <span class="fa fa-bars text-info">商品详细管理</span>
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown2">
                        <a class="fa fa-plus dropdown-item text-info" href="#">添加</a>
                        <div class="dropdown-divider"></div>
                        <a class="fa fa-pencil dropdown-item text-warning" href="#">修改</a>
                        <div class="dropdown-divider"></div>
                        <a class="fa fa-search dropdown-item text-info" href="#">查询</a>
                        <div class="dropdown-divider"></div>
                        <a class="fa fa-trash dropdown-item text-danger" href="#">删除</a>
                    </div>
                </li>

                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown4" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <span class="fa fa-bars text-info">权限角色管理</span>
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown4">
                        <a class="fa fa-plus dropdown-item text-info" href="#">添加</a>
                        <div class="dropdown-divider"></div>
                        <a class="fa fa-pencil dropdown-item text-warning" href="#">修改</a>
                        <div class="dropdown-divider"></div>
                        <a class="fa fa-search dropdown-item text-info" href="#">查询</a>
                        <div class="dropdown-divider"></div>
                        <a class="fa fa-trash dropdown-item text-danger" href="#">删除</a>
                    </div>
                </li>

                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown3" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <span class="fa fa-bars text-info">用户角色管理</span>
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown3">
                        <a class="fa fa-plus dropdown-item text-info" href="#">添加</a>
                        <div class="dropdown-divider"></div>
                        <a class="fa fa-pencil dropdown-item text-warning" href="#">修改</a>
                        <div class="dropdown-divider"></div>
                        <a class="fa fa-search dropdown-item text-info" href="#">查询</a>
                        <div class="dropdown-divider"></div>
                        <a class="fa fa-trash dropdown-item text-danger" href="#">删除</a>
                    </div>
                </li>

            </ul>
            <!--全屏-->
            <a href="#" class="nav-link fa fa-arrows-alt" id="full"></a>

            <form class="form-inline my-2 my-lg-0">
                <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
                <button class="btn btn-outline-success my-2 my-sm-0" type="submit"><i class="fa fa-search"></i></button>
            </form>


        </div>

        <div class="dropdown mr-5">
            <a class="nav-link dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <img class="card-img-top" src="holder.js/20x20" alt="Card image cap">
            </a>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                <a class="dropdown-item" href="#">个人中心</a>
                <a class="dropdown-item" href="#">修改密码</a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="#">退出系统</a>
            </div>
        </div>



        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
    </nav>
    <div class="row mt-2 mb-2">
        <div class="col-lg-2" id="leftnav">
            <div id="accordion">
                <div class="card" id="headingOne">

                    <h5 class="mb-0">
                        <button class="btn btn-block btn-info text-left" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                            <i class="fa fa-bars"></i>&nbsp;&nbsp;用户管理
                        </button>
                    </h5>

                    <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#accordion">
                        <div class="list-group">
                            <a href="#" class="fa fa-plus list-group-item list-group-item-添加 list-group-item-primary">添加</a>
                            <a href="#" class="fa fa-pencil list-group-item list-group-item-添加 list-group-item-secondary">修改 </a>
                            <a href="#" class="fa fa-search list-group-item list-group-item-添加 list-group-item-success">查询</a>
                            <a href="#" class="fa fa-trash list-group-item list-group-item-添加 list-group-item-danger">删除</a>
                        </div>
                    </div>
                </div>

                <div class="card mt-1" id="headingTwo">

                    <h5 class="mb-0">
                        <button class="btn btn-block btn-info text-left text-left" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="true" aria-controls="collapseOne">
                            <i class="fa fa-bars"></i>&nbsp;&nbsp;商品分类管理
                        </button>
                    </h5>
                    <div id="collapseTwo" class="collapse show" aria-labelledby="headingTwo" data-parent="#accordion">
                        <div class="list-group">
                            <a href="#" class="fa fa-plus list-group-item list-group-item-添加 list-group-item-primary">添加</a>
                            <a href="#" class="fa fa-pencil list-group-item list-group-item-添加 list-group-item-secondary">修改 </a>
                            <a href="#" class="fa fa-search list-group-item list-group-item-添加 list-group-item-success">查询</a>
                            <a href="#" class="fa fa-trash list-group-item list-group-item-添加 list-group-item-danger">删除</a>
                        </div>
                    </div>
                </div>

                <div class="card mt-1" id="headingThree">

                    <h5 class="mb-0">
                        <button class="btn btn-block btn-info text-left" data-toggle="collapse" data-target="#collapseThree" aria-expanded="true" aria-controls="collapseOne">
                            <i class="fa fa-bars"></i>&nbsp;&nbsp;角色管理
                        </button>
                    </h5>


                    <div id="collapseThree" class="collapse show" aria-labelledby="headingThree" data-parent="#accordion">
                        <div class="list-group">
                            <a href="#" class="fa fa-plus list-group-item list-group-item-添加 list-group-item-primary">添加</a>
                            <a href="#" class="fa fa-pencil list-group-item list-group-item-添加 list-group-item-secondary">修改 </a>
                            <a href="#" class="fa fa-search list-group-item list-group-item-添加 list-group-item-success">查询</a>
                            <a href="#" class="fa fa-trash list-group-item list-group-item-添加 list-group-item-danger">删除</a>
                        </div>
                    </div>
                </div>

                <div class="card mt-1" id="headingFour">

                    <h5 class="mb-0">
                        <button class="btn btn-block btn-info text-left" data-toggle="collapse" data-target="#collapseFour" aria-expanded="true" aria-controls="collapseOne">
                            <i class="fa fa-bars"></i>&nbsp;&nbsp;权限管理
                        </button>
                    </h5>

                    <div id="collapseFour" class="collapse show" aria-labelledby="headingFour" data-parent="#accordion">
                        <div class="list-group">
                            <a href="#" class="fa fa-plus list-group-item list-group-item-添加 list-group-item-primary">添加</a>
                            <a href="#" class="fa fa-pencil list-group-item list-group-item-添加 list-group-item-secondary">修改 </a>
                            <a href="#" class="fa fa-search list-group-item list-group-item-添加 list-group-item-success">查询</a>
                            <a href="#" class="fa fa-trash list-group-item list-group-item-添加 list-group-item-danger">删除</a>
                        </div>
                    </div>
                </div>

                <div class="card mt-1" id="headingFive">

                    <h5 class="mb-0">
                        <button class="btn btn-block btn-info text-left" data-toggle="collapse" data-target="#collapseFive" aria-expanded="true" aria-controls="collapseOne">
                            <i class="fa fa-bars"></i>&nbsp;&nbsp;购物车管理
                        </button>
                    </h5>

                    <div id="collapseFive" class="collapse show" aria-labelledby="headingFive" data-parent="#accordion">
                        <div class="list-group">
                            <a href="#" class="fa fa-plus list-group-item list-group-item-添加 list-group-item-primary">添加</a>
                            <a href="#" class="fa fa-pencil list-group-item list-group-item-添加 list-group-item-secondary">修改</a>
                            <a href="#" class="fa fa-search list-group-item list-group-item-添加 list-group-item-success">查询</a>
                            <a href="#" class="fa fa-trash list-group-item list-group-item-添加 list-group-item-danger">删除</a>
                        </div>
                    </div>
                </div>

                <div class="card mt-1" id="headingSix">

                    <h5 class="mb-0">
                        <button class="btn btn-block btn-info text-left" data-toggle="collapse" data-target="#collapseSix" aria-expanded="true" aria-controls="collapseOne">
                            <i class="fa fa-bars"></i>&nbsp;&nbsp;二手书管理
                        </button>
                    </h5>

                    <div id="collapseSix" class="collapse show" aria-labelledby="headingSix" data-parent="#accordion">
                        <div class="list-group">
                            <a href="#" class="fa fa-plus list-group-item list-group-item-添加 list-group-item-primary">添加</a>
                            <a href="#" class="fa fa-pencil list-group-item list-group-item-添加 list-group-item-secondary">修改 </a>
                            <a href="#" class="fa fa-search list-group-item list-group-item-添加 list-group-item-success">查询</a>
                            <a href="#" class="fa fa-trash list-group-item list-group-item-添加 list-group-item-danger">删除</a>
                        </div>
                    </div>
                </div>

                <div class="card mt-1" id="headingSeven">

                    <h5 class="mb-0">
                        <button class="btn btn-block btn-info text-left" data-toggle="collapse" data-target="#collapseSeven" aria-expanded="true" aria-controls="collapseOne">
                            <i class="fa fa-bars"></i>&nbsp;&nbsp;二手商品管理
                        </button>
                    </h5>

                    <div id="collapseSeven" class="collapse show" aria-labelledby="headingSeven" data-parent="#accordion">
                        <div class="list-group">
                            <a href="#" class="fa fa-plus list-group-item list-group-item-添加 list-group-item-primary">添加</a>
                            <a href="#" class="fa fa-pencil list-group-item list-group-item-添加 list-group-item-secondary">修改 </a>
                            <a href="#" class="fa fa-search list-group-item list-group-item-添加 list-group-item-success">查询</a>
                            <a href="#" class="fa fa-trash list-group-item list-group-item-添加 list-group-item-danger">删除</a>
                        </div>
                    </div>
                </div>

                <div class="card mt-1" id="headingEight">

                    <h5 class="mb-0">
                        <button class="btn btn-block btn-info text-left" data-toggle="collapse" data-target="#collapseEight" aria-expanded="true" aria-controls="collapseEight">
                            <i class="fa fa-bars"></i>&nbsp;&nbsp;订单管理
                        </button>
                    </h5>

                    <div id="collapseEight" class="collapse show" aria-labelledby="headingEight" data-parent="#accordion">
                        <div class="list-group">
                            <a href="#" class="fa fa-plus list-group-item list-group-item-添加 list-group-item-primary">添加</a>
                            <a href="#" class="fa fa-pencil list-group-item list-group-item-添加 list-group-item-secondary">修改 </a>
                            <a href="#" class="fa fa-search list-group-item list-group-item-添加 list-group-item-success">查询</a>
                            <a href="#" class="fa fa-trash list-group-item list-group-item-添加 list-group-item-danger">删除</a>
                        </div>
                    </div>
                </div>

                <div class="card mt-1" id="headingNine">

                    <h5 class="mb-0">
                        <button class="btn btn-block btn-info text-left" data-toggle="collapse" data-target="#collapseNine" aria-expanded="true" aria-controls="collapseEight">
                            <i class="fa fa-bars"></i>&nbsp;&nbsp;商品订单管理
                        </button>
                    </h5>

                    <div id="collapseNine" class="collapse show" aria-labelledby="headingNine" data-parent="#accordion">
                        <div class="list-group">
                            <a href="#" class="fa fa-plus fa fa-plus list-group-item list-group-item-添加 list-group-item-primary">添加</a>
                            <a href="#" class="fa fa-pencil fa fa-pencil list-group-item list-group-item-添加 list-group-item-secondary">修改 </a>
                            <a href="#" class="fa fa-search fa fa-search list-group-item list-group-item-添加 list-group-item-success">查询</a>
                            <a href="#" class="fa fa-trash list-group-item list-group-item-添加 list-group-item-danger">删除</a>
                        </div>
                    </div>
                </div>

                <div class="card mt-1" id="headingTen">

                    <h5 class="mb-0">
                        <button class="btn btn-block btn-info text-left" data-toggle="collapse" data-target="#collapseTen" aria-expanded="true" aria-controls="collapseEight">
                            <i class="fa fa-bars"></i>&nbsp;&nbsp;学院信息管理
                        </button>
                    </h5>

                    <div id="collapseTen" class="collapse show" aria-labelledby="headingTen" data-parent="#accordion">
                        <div class="list-group">
                            <a href="#" class="fa fa-plus list-group-item list-group-item-添加 list-group-item-primary">添加</a>
                            <a href="#" class="fa fa-pencil list-group-item list-group-item-添加 list-group-item-secondary">修改 </a>
                            <a href="#" class="fa fa-search list-group-item list-group-item-添加 list-group-item-success">查询</a>
                            <a href="#" class="fa fa-trash list-group-item list-group-item-添加 list-group-item-danger">删除</a>
                        </div>
                    </div>
                </div>

            </div>
        </div>
        <div class="col-lg-10">


            <h6><i class="fa fa-user-plus"></i>新增角色</h6>
            <hr>
            <h6 class="text-info">基本信息</h6>
            <hr>

            <div class="row">

                <div class="col-lg-6">
                    <div class="form-group row">
                        <label for="roleNum" class="col-sm-2 col-form-label">编号</label>
                        <div class="col-sm-10">
                            <input v-model="role.roleNum" id="roleNum" type="text" class="form-control"  placeholder="前输入编号">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="roleName" class="col-sm-2 col-form-label">角色名</label>
                        <div class="col-sm-10">
                            <input v-model="role.roleName" id="roleName" type="text" class="form-control" placeholder="请输入角色名">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="roleDes" class="col-sm-2 col-form-label">描述</label>
                        <div class="col-sm-10">
                            <textarea v-model="role.roleDes" id="roleDes" class="form-control"></textarea>
                        </div>
                    </div>
                    <button @click="showInfo" class="btn btn-info">添加</button>
                    <button class="btn btn-warning">重置</button>
                </div>
            </div>

        </div>
    </div>

        <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLongTitle">用户提示</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>

                    <div class="modal-body">
                        <div class="thumbnail">
                            <h3>角色信息</h3>
                            <div class="caption">
                                <p class="text-info">角色编号:{{role.roleNum}}</p>
                                <p class="text-info">角色名:{{role.roleName}}</p>
                                <p class="text-info">角色描述:{{role.roleDes}}</p>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">返回修改</button>
                        <button @click="add" type="button" class="btn btn-primary">添加</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

<script>

    new Vue({
        el:'#roleInfo',
        data:{
            role:{
                roleNum:'',
                roleName:'',
                roleDes:'',
            },
            errors:[],
        },
        methods:{

            showInfo(){

                this.errors=[];
                this.check(this.role)

                let {errors} = this

                if(errors.length>0){
                    let str = '';
                    this.errors.forEach(item=>{
                        str+=`<h4 class="text-danger">${item}</h4>` ;
                    })
                    $.dialog({
                        type:'alert',
                        titleText:'警告',
                        contentHtml:str,
                        autoClose:2000,
                    })
                }else{

                    $('#exampleModal').modal()
                }
            },

            add(){

                let infoDialog = $.dialog({
                    type : 'info',
                    infoText : '加载中…',
                    infoIcon : '../images/icon/loading.gif'
                });
                axios.baseURL='http://localhost:8080';
                axios.defaults.withCredentials=true;
                axios.post('/role/add/',this.qs(this.role)).then(res=>{

                    let {message,code}= res.data;
                    if(code==='1'){
                        infoDialog.dialog.update({
                            autoClose : 1500,
                            infoText : message,
                            infoIcon : 'images/icon/success.png'
                        });

                        $('#exampleModal').modal('hide')
                        for(let key in this.role){

                            this.role[key]='';
                        }
                    }else{

                        let str='';

                        let errors = res.data.errors.AllError

                        let errors1=res.data.errors.errors;

                        for(let i in errors1){

                            let info=errors1[i]
                            str+=`<h4 class='text-danger'>${info}</h4>`;
                        }

                        for(let i in errors){
                            errors[i].forEach((item,index)=>{
                                str+=`<h4 class='text-danger'>${item}</h4>`;
                            })
                        }
                        $.dialog({
                            type:'alert',
                            titleText:message,
                            contentHtml: str,
                        })
                    }
                }).catch(err=>{

                    infoDialog.dialog.update({
                        autoClose : 1500,
                        infoText : '网络异常',
                        infoIcon : 'images/icon/fail.png'
                    });
                })

            },

            check({roleNum,roleName}){

                let num= validator.isEmpty(roleName);

                let name =validator.isEmpty(roleName);

                if(num){
                    this.errors.push("编号不能为空")
                }
                if(name){
                    this.errors.push("角色名不能为空")
                }
            },
            qs(obj){

                console.log(Qs.stringify(obj))
                return Qs.stringify(obj)
            }


        }





    })


</script>
</html>